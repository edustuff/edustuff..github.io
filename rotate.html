<!DOCTYPE html>
<html>

<head>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="user-scalable=no, width=device-width" />
    <link rel="apple-touch-icon" href="Icon2dx.png" />
</head>


<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    display: flex;
    justify-content: center;
  }

  #target {
    margin-top: 50px;
    font-family: "Helvetica Neue", sans-serif;
    font-weight: 100;
    font-size: 150px;
    color: #777;
    -webkit-font-smoothing: antialiased;
  }

  #aim {
    margin-top: 400px;
    font-family: "Helvetica Neue", sans-serif;
    font-weight: 100;
    font-size: 150px;
    color: #777;
    -webkit-font-smoothing: antialiased;
  }

  #target:hover {
    color: orange;
    cursor: pointer;
  }
</style>
<body>
<div>
<div id="target">A</div>
</div>
<div>
<div id="aim">A</div>
</div>
<script>
// Generated by CoffeeScript 1.6.3
(function() {
  var R2D, active, angle, center, init, rotate, rotation, start, startAngle, stop;

  active = false;

  angle = 0;

  rotation = 0;

  startAngle = 0;

  center = {
    x: 0,
    y: 0
  };

  document.ontouchmove = function(e) {
    //return e.preventDefault();
  };

  init = function() {
    target.addEventListener("touchstart", start, false);
    target.addEventListener("touchmove", rotate, false);
    return target.addEventListener("touchend", stop, false);
  };

  R2D = 180 / Math.PI;

  start = function(e) {
    var height, left, top, width, x, y, _ref;
    e.preventDefault();
    _ref = this.getBoundingClientRect(), top = _ref.top, left = _ref.left, height = _ref.height, width = _ref.width;
    center = {
      x: left + (width / 2),
      y: top + (height / 2)
    };
    <!--console.log(e.touches[0]);-->
    x = e.touches[0].clientX - center.x;
    y = e.touches[0].clientY - center.y;
    startAngle = R2D * Math.atan2(y, x);
    return active = true;
  };

  rotate = function(e) {
    var d, x, y;
    e.preventDefault();
    x = e.touches[0].clientX - center.x;
    y = e.touches[0].clientY - center.y;
    d = R2D * Math.atan2(y, x);
    rotation = d - startAngle;
    rotation = Math.round(rotation / 30) * 30
    if (active) {
      return this.style.webkitTransform = "rotate(" + (angle + rotation) + "deg)";
    }
  };

  stop = function() {
    angle += rotation;
    return active = false;
  };

  init();

}).call(this);
</script>

