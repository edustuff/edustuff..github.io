<!DOCTYPE html>
<html>

<head>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="user-scalable=no, width=device-width" />
    <link rel="apple-touch-icon" href="Icon2dx.png" />
</head>


<!DOCTYPE html>
<meta charset="utf-8">
<style>
  .flex {
    display: flex;

    align-items: center;
  }

  .center {
    margin: auto;
    width: 50%;
    }

  #target {
    margin-top: 50px;
    font-family: "Wingdings";
    font-weight: 100;
    font-size: 150px;
    color: blue;
    -webkit-font-smoothing: antialiased;
  }

  #aim {
    margin-top: 50px;
    font-family: "Wingdings";
    font-weight: 100;
    font-size: 150px;
    color: red;
    -webkit-font-smoothing: antialiased;
  }

</style>
<body>
<div>
    <P>
        Rotate the blue shape so that it looks the same as the red shape and then click next.
    </P>
    <button onclick="compare();" style="border-style: solid; border-width: medium; font-size: 150%;">Next</button>
    <button onclick="newSymbol();" style="float: right; border-style: solid; border-width: medium; font-size: 100%;">Skip</button>
</div>
<div class="flex center">
<div id="target">b</div>
</div>
<div class="flex center">
<div id="aim">b</div>
</div>
<script>

function compare() {
    if (randomAngle == result) {
        alert("Correct!");
        newSymbol();
    }
    else {
        alert("Try again");
    }
}

function newSymbol() {

    randomSymbol = (Math.random() * 218) + 33

    document.getElementById("target").innerHTML = String.fromCharCode(randomSymbol);
    document.getElementById("aim").innerHTML = String.fromCharCode(randomSymbol);

    randomAngle = Math.floor((Math.random() * 240) + 30);
    randomAngle = Math.round(randomAngle / 30) * 30;
    document.getElementById("aim").style.webkitTransform = "rotate(" + (randomAngle) + "deg)";

}

// Generated by CoffeeScript 1.6.3
(function() {

  newSymbol();

  result = 0;

  var R2D, active, angle, center, init, rotate, rotation, start, startAngle, stop;

  active = false;

  angle = 0;

  rotation = 0;

  startAngle = 0;

  center = {
    x: 0,
    y: 0
  };

  document.ontouchmove = function(e) {
    //return e.preventDefault();
  };

  init = function() {
    target.addEventListener("touchstart", start, false);
    target.addEventListener("touchmove", rotate, false);
    return target.addEventListener("touchend", stop, false);
  };

  R2D = 180 / Math.PI;

  start = function(e) {
    var height, left, top, width, x, y, _ref;
    e.preventDefault();
    _ref = this.getBoundingClientRect(), top = _ref.top, left = _ref.left, height = _ref.height, width = _ref.width;
    center = {
      x: left + (width / 2),
      y: top + (height / 2)
    };
    <!--console.log(e.touches[0]);-->
    x = e.touches[0].clientX - center.x;
    y = e.touches[0].clientY - center.y;
    startAngle = R2D * Math.atan2(y, x);
    return active = true;
  };

  rotate = function(e) {
    var d, x, y;
    e.preventDefault();
    x = e.touches[0].clientX - center.x;
    y = e.touches[0].clientY - center.y;
    d = R2D * Math.atan2(y, x);
    rotation = d - startAngle;
    rotation = Math.round(rotation / 30) * 30;
    <!--if (rotation < 0) rotation = rotation + 360;-->
    if (active) {
        result = angle + rotation
        if (result < 0) result = result + 360
        if (result >=360) result = result - 360
        console.log(result)
      return this.style.webkitTransform = "rotate(" + (result) + "deg)";
    }
  };

  stop = function() {
    angle += rotation;
    return active = false;
  };

  init();

}).call(this);
</script>

